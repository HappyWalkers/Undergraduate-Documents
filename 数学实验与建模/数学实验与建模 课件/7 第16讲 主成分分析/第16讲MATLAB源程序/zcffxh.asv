clc,clear
X=[2027.96 	552.323 	407.608 	2.060 	23.344 	17.6780 	237.668	182.68 	78.2 	33.658 	0.4296 	214.8 	68.1
2128.82 	627.273 	223.956 	9.930 	26.988 	27.4550 	229.136	80.60 	77.5 	30.811 	0.4637 	235.8 	74
8397.28 	586.637 	157.512 	8.080 	21.714 	164.9927 273.758	82.68 	71.3 	19.209 	0.4085 	250.7 	74.6
2144.68 	530.618 	79.264 	3.770 	10.715 	26.9679 	237.766	139.70 	53.3 	15.435 	0.2653 	191.9 	71.2
1844.00 	583.934 	120.184 	9.490 	17.734 	6.6502 	195.46	505.04 	65.7 	31.440 	0.3956 	212.5 	72.1
3434.17 	538.182 	45.766 	2.830 	10.604 	7.7272 	223.817	200.34 	71.6 	36.680 	0.2748 	240.3 	66.3
2391.16 	486.456 	60.356 	5.820 	9.115 	9.8648 	303.95	61.00 	71.4 	25.498 	0.1755 	214.8 	65.3
1950.76 	559.364 	240.972 	5.710 	14.660 	115.5546 196.99	212.20 	59.1 	50.337 	0.4143 	214.8 	66
2262.72 	700.004 	240.430 	13.230 	30.513 	58.5407 	194.925	175.52 	78.3 	16.773 	0.6644 	214.8 	78.2
1364.14 	544.508 	43.786 	2.450 	9.258 	28.7475 	161.421	255.20 	71.3 	10.329 	0.3252 	181.5 	68.8
2355.69 	541.872 	7.377 	9.290 	6.046 	25.5751 	237.891	177.90 	58.1 	14.163 	0.2788 	214.8 	61.6
2556.79 	494.192 	31.923 	6.080 	12.261 	2.4802 	262.155	193.04 	63.8 	20.986 	0.1971 	248.7 	68.3
1416.11 	607.043 	64.902 	4.300 	14.097 	40.7586 	212.237	155.50 	68.3 	27.982 	0.4400 	221.7 	68.8
1237.81 	600.680 	139.841 	5.730 	14.591 	134.6375 255.335	203.90 	66.3 	41.478 	0.3593 	197.7 	72.6
2177.91 	522.340 	52.376 	6.230 	11.734 	9.7179 	208.933	159.70 	67.4 	25.646 	0.2188 	233.4 	65.7
1553.50 	582.571 	60.248 	9.030 	11.184 	8.1900 	189.275	110.90 	71.4 	13.552 	0.2366 	203.3 	69.9
1713.65 	549.606 	58.999 	5.880 	15.745 	43.8121 	271.504	446.70 	71.2 	17.079 	0.3581 	238.2 	74.5
2398.38 	514.567 	38.850 	3.60 	7.239 	6.5161 	265.773	195.04 	62.5 	26.982 	0.2254 	203.3 	65.4
2463.60 	545.215 	115.301 	5.560 	18.398 	31.2649 	220.333	172.00 	67.6 	30.315 	0.3791 	212.5 	72.6
2273.63 	560.145 	23.110 	3.510 	11.981 	9.6262 	227.338	303.10 	59.4 	12.343 	0.2817 	214.8 	75.8
6346.83 	562.996 	88.879 	15.510 	16.746 	47.2196 	259.11	140.20 	60.0 	18.026 	0.3789 	224.1 	72.2
2566.61 	488.030 	73.606 	6.490 	17.340 	13.8003 	226.399	102.60 	56.3 	21.727 	0.2834 	219.5 	71.6
2380.81 	542.161 	172.217 	4.080 	29.704 	44.7476 	212.564	272.60 	77.5 	16.311 	0.5715 	205.7 	77.1
1638.83 	532.951 	144.453 	8.360 	8.721 	14.3803 	244.512	518.63 	76.5 	14.973 	0.2828 	191.9 	71.5
1409.70 	536.278 	49.236 	2.870 	12.205 	30.2112 	156.038	289.64 	58.9 	14.186 	0.3505 	193.4 	68.2
851.17 	586.422 	58.045 	7.150 	7.187 	13.9166 	197.377	793.60 	68.7 	31.934 	0.3169 	198.3 	72
1116.61 	529.829 	33.778 	6.230 	8.881 	15.9809 	213.216	277.16 	59.4 	22.936 	0.2647 	204.7 	71.5];

x=zscore(X);         %数据标准化
std=CORRCOEF(x);   %计算相关系数矩阵
[vec,val]=eig(std);   %求特征值(val)及特征向量(vec)
newval=diag(val) ;  %将特征值作成一个新向量
[y,i]=sort(newval)   %对特征根进行排序，y为排序结果，i为索引
rate=y/sum(y)   %计算贡献率
sumrate=0;
newi=[];
for k=length(y):-1:1
    sumrate=sumrate+rate(k);
    newi(length(y)+1-k)=i(k);
    if sumrate>0.85 break;
    end  
end                %记下累积贡献率大85%的特征值的序号放入newi中
fprintf('主成分数：%g\n\n',length(newi));
fprintf('计算主成分载荷：\n')
for i=1:1:length(newi)
    for j=1:1:length(y)
       aa(i,j)=sqrt(newval(newi(i)))*vec(j,newi(i));
    end
end                    %计算载荷
aa
for i=1:1:length(newi)
        aaa1(i)=0;
end
for i=1:1:length(newi)
    for j=1:1:length(y)
        aaa1(i)=aaa1(i)+aa(i,j)*aa(i,j);
    end
end                         %主成分载荷归一化
for i=1:1:length(newi)
    for j=1:1:length(y)
        aaa(i,j)=aa(i,j)/sqrt(aaa1(i));
end
end                %主成分载荷归一化
fprintf('主成分载荷：\n'),a=aaa             %主成分载荷

!A=((result))'*X';
A=(a)*X';
B=[]
for i=1:28
B(i,1)=sum(A(:,i)); %计算酿酒葡萄得分
end
B
