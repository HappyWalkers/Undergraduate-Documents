clear
close all
clc

% UG1K=7.0V    电流量程 1uA   灯丝电源电压 3.6V   UG2P=7.0V
UI1 = [0.5  1  1.5  2  2.5  3  3.5  4  4.5  5  5.5  6  6.5  7  7.5  8  8.5  9  9.5  10  10.5  11  11.5  12  12.5  13  13.5  14  14.5  15  15.5  16  16.5  17  17.5  18  18.5  19  19.5  20  20.5  21  21.5  22  22.5  23  23.5  24  24.5  25  25.5  26  26.5  27  27.5  28  28.5  29  29.5  30  30.5  31  31.5  32  32.5  33  33.5  34  34.5  35  35.5  36  36.5  37  37.5  38  38.5  39  39.5  40  40.5  41  41.5  42  42.5  43  43.5  44  44.5  45  45.5  46  46.5  47  47.5  48  48.5  49  49.5  50  50.5  51  51.5  52  52.5  53  53.5  54  54.5  55  55.5  56  56.5  57  57.5  58  58.5  59  59.5  60  60.5  61  61.5  62  62.5  63  63.5  64  64.5  65  65.5  66  66.5  67  67.5  68  68.5  69  69.5  70  70.5  71  71.5  72  72.5  73  73.5  74  74.5  75  75.5  76  76.5  77  77.5  78  78.5  79  79.5  80
    0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.4  0.9  1.7  1.7  4  5.2  6.3  7.5  8.9  10.3  11.3  11  12.5  14.7  17.3  19.9  22.1  24.2  26.2  28.1  29.9  31.3  31.3  31.7  32.4  33.2  33.9  34.2  34.3  34.1  33.5  32.5  31.2  29.9  28.6  27.7  27.6  28.4  30.9  35.7  41  48.1  54.2  61.5  67  71.1  73.9  75.6  75.9  74.1  71.5  67.4  61.5  54.5  48.1  42.2  36.6  32.3  29.2  30.7  36  44.2  55.6  68.2  79.9  91.2  99.5  106.7  110.8  115.4  117.2  111.6  109.4  102.8  94.1  82.7  69.5  59.2  46.7  36.5  31.6  32  40.6  53.4  67  83.2  97.5  111.7  128  137.2  143.8  146.8  152.2  154.1  154.6  146.5  140.6  133.3  122.5  109  93.4  78.7  65.1  54.8  49.3  50.4  62.8  77.3  93.8  109.7  126.1  139.6  152.2  160.8  170.8  178.3  185.3  188.7  188.9  180.9  177.7  171.4  160.3  142.7  125.9  110.7  94.5  85.4  78.7  79.1  87.9  103.5  119.5  135.9  152  165.8  178.9  189.9  199.8  208.8  214.3  217.4  219.5  219.1  215.6];
U1 = UI1(1,:);
I1 = UI1(2,:);

% UG1K=2.0V    电流量程 1uA   灯丝电源电压 3.6V   UG2P=7.5V
UI2 = [0.5  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5  10.0  10.5  11.0  11.5  12.0  12.5  13.0  13.5  14.0  14.5  15.0  15.5  16.0  16.5  17.0  17.5  18.0  18.5  19.0  19.5  20.0  20.5  21.0  21.5  22.0  22.5  23.0  23.5  24.0  24.5  25.0  25.5  26.0  26.5  27.0  27.5  28.0  28.5  29.0  29.5  30.0  30.5  31.0  31.5  32.0  32.5  33.0  33.5  34.0  34.5  35.0  35.5  36.0  36.5  37.0  37.5  38.0  38.5  39.0  39.5  40.0  40.5  41.0  41.5  42.0  42.5  43.0  43.5  44.0  44.5  45.0  45.5  46.0  46.5  47.0  47.5  48.0  48.5  49.0  49.5  50.0  50.5  51.0  51.5  52.0  52.5  53.0  53.5  54.0  54.5  55.0  55.5  56.0  56.5  57.0  57.5  58.0  58.5  59.0  59.5  60.0  60.5  61.0  61.5  62.0  62.5  63.0  63.5  64.0  64.5  65.0  65.5  66.0  66.5  67.0  67.5  68.0  68.5  69.0  69.5  70.0  70.5  71.0  71.5  72.0  72.5  73.0  73.5  74.0  74.5  75.0  75.5  76.0  76.5  77.0  77.5  78.0  78.5  79.0  79.5  80.0
    3.3  2.9  2.7  2.6  2.4  2.4  2.3  2.2  1.9  1.8  1.7  1.7  1.7  1.4  1.3  1.1  0.9  0.8  0.7  0.6  0.7  0.8  1.2  1.8  2.4  3.3  4.4  5.6  7.0  8.5  10.0  11.9  13.5  15.5  17.0  18.0  20.6  22.8  25.9  27.5  28.6  29.1  29.6  30.0  30.2  30.1  29.9  29.4  28.9  28.1  27.3  24.5  22.1  20.3  25.1  29.1  33.4  38.8  44.6  49.4  53.1  56.3  59.4  61.5  62.8  63.3  62.4  60.4  57.4  53.8  47.8  43.8  38.6  34.0  30.5  24.9  34.3  39.4  46.3  55.2  62.9  71.8  81.4  89.5  97.7  100.8  102.3  101.9  99.6  95.0  89.8  82.9  75.4  64.8  54.9  46.0  38.1  31.9  35.9  48.3  65.3  76.2  90.1  104.2  113.7  122.8  128.1  133.8  138.8  141.9  142.2  139.6  129.6  121.2  109.3  95.3  79.5  65.2  54.7  46.6  42.1  43.5  51.5  63.1  83.4  102.7  117.3  129.2  137.9  145.9  154.4  163.5  167.7  171.6  172.0  169.6  164.1  151.9  139.7  129.2  116.1  93.7  84.3  77.8  74.3  75.2  81.9  95.5  105.9  124.6  136.6  150.1  164.5  176.9  186.8  191.9  196.3  201.2  203.9  203.6];
U2 = UI2(1,:);
I2 = UI2(2,:);

n = 1000;
U_i = linspace(min([U1 U2]), max([U1 U2]), n);

% newgrnn, newrb, newrbe, newpnn
I1_i = spline(U1, I1, U_i);
net1 = newgrnn(U1, I1);
I1_i_rnn = sim(net1, U_i);
I1_i_rnn1 = sim(net1, U1);


I2_i = spline(U2, I2, U_i);
net2 = newrbe(U2, I2);
I2_i_rnn = sim(net2, U_i);
I2_i_rnn2 = sim(net2, U2);

figure;
plot(U1, I1, 'ko');
hold on;
plot(U2, I2, 'ro');
legend('第1组：U_{G1K}=7.0V, U_{G2P}=7.0V', '第2组：U_{G1K}=2.0V, U_{G2P}=7.5V', 'location', 'northwest');
xlabel('U_{G2K}');
ylabel('I_{P}');
title('两组不同实验数据');

figure;
plot(U1, I1, 'ko');
hold on;
plot(U_i, I1_i, 'k-');
plot(U_i, I1_i_rnn, 'r-');
plot(U1, I1_i_rnn1, 'r.', 'MarkerSize', 18);
legend('实验数据', '三次样条插值曲线', '神经网络拟合曲线', 'location', 'northwest');
xlabel('U_{G2K}');
ylabel('I_{P}');
title('第1组：U_{G1K}=7.0V, U_{G2P}=7.0V');

figure;
plot(U2, I2, 'ko');
hold on;
plot(U_i, I2_i, 'k-');
plot(U_i, I2_i_rnn, 'r-');
plot(U2, I2_i_rnn2, 'r.', 'MarkerSize', 18);
legend('实验数据', '三次样条插值曲线', '神经网络拟合曲线', 'location', 'northwest');
xlabel('U_{G2K}');
ylabel('I_{P}');
title('第2组：U_{G1K}=2.0V, U_{G2P}=7.5V');
